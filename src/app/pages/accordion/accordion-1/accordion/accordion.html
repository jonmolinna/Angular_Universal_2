<div class="w-full" [ngClass]="containerClasses()">
  @for (item of items; track item.id; let i = $index) {
  <div class="accordion-item" [ngClass]="itemClasses(i)">
    <!-- Accordion Header -->
    <button
      type="button"
      class="accordion-header w-full text-left transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
      [class.cursor-not-allowed]="item.disabled"
      [class.opacity-50]="item.disabled"
      [ngClass]="headerClasses(item)"
      [disabled]="item.disabled"
      [attr.aria-expanded]="isExpanded(item.id)"
      [attr.aria-controls]="'accordion-content-' + item.id"
      [attr.id]="'accordion-header-' + item.id"
      (click)="toggle(item.id)"
    >
      <div class="flex items-center justify-between py-4 px-5">
        <!-- Left side: Icon + Title + Badge -->
        <div class="flex items-center space-x-3 flex-1">
          <!-- Custom Icon -->
          @if(item.icon) {
          <span class="text-lg flex-shrink-0">{{ item.icon }}</span>
          }

          <!-- Custom Header Content -->
          <ng-content [select]="'[slot=header-' + item.id + ']'">
            <!-- Default Title -->
            <span
              class="font-medium text-gray-900 transition-colors duration-200"
              [class.text-blue-600]="isExpanded(item.id)"
            >
              {{ item.title }}
            </span>
          </ng-content>

          <!-- Badge -->
          @if (item.badge) {
          <span
            class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
          >
            {{ item.badge }}
          </span>
          }
        </div>

        <!-- Right side: Chevron -->
        <div class="flex-shrink-0 ml-3">
          <svg
            class="h-5 w-5 text-gray-500 transition-transform duration-300 ease-in-out"
            [class.rotate-180]="isExpanded(item.id)"
            [class.text-blue-600]="isExpanded(item.id)"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
          </svg>
        </div>
      </div>
    </button>

    <!-- Accordion Content -->
    <div
      class="accordion-content overflow-hidden transition-all duration-300 ease-in-out"
      [class.max-h-0]="!isExpanded(item.id)"
      [class.max-h-screen]="isExpanded(item.id)"
      [class.opacity-0]="!isExpanded(item.id)"
      [class.opacity-100]="isExpanded(item.id)"
      [attr.id]="'accordion-content-' + item.id"
      [attr.aria-labelledby]="'accordion-header-' + item.id"
      [attr.aria-hidden]="!isExpanded(item.id)"
    >
      <div class="accordion-content-inner px-5 pb-4" [ngClass]="contentClasses()">
        <!-- Custom Content -->
        <ng-content [select]="'[slot=content-' + item.id + ']'">
          <!-- Default Content -->
          @if (item.content) {
          <div class="text-gray-700 text-sm leading-relaxed" [innerHTML]="item.content"></div>
          }
        </ng-content>
      </div>
    </div>
  </div>
  }
</div>
